# Pub3ToCytoscape

## Description

Pub3ToCytoscape is a tool developed in Python to extract BioConcept entities (e.g., genes, diseases, chemicals, and species) from the Pubtator file generated by [Pubtator3](https://www.ncbi.nlm.nih.gov/research/pubtator3/). Pub3ToCytoscape calculates the frequency of each BioConcept pair (e.g., gene-gene, gene-chemical, chemical-disease) based on co-mentions in publications, and generates a co-mention interaction network for these BioConcept entities. The network can be imported into [Cytoscape](https://cytoscape.org/) for visualization and further network analyses.

## Package Requirements

```
pip install -r requirements.txt
```

## Example Usage

1. Get a PubTator file generated from related articles by using [PubTator3 API](https://www.ncbi.nlm.nih.gov/research/pubtator3/api)  
```
# Query with keywords
python pubtator3_api.py -q "N-dimethylnitrosamine and Metformin" [-o OUTPUT_FILEPATH]

# Query with article PMIDs
python pubtator3_api.py -p 34895069,35883435,34205807 [-o OUTPUT_FILEPATH]

# Query with article PMIDs (from file)
python pubtator3_api.py -f examples/pmids.txt [-o OUTPUT_FILEPATH]

# Query with PubTator3 Entity ID (See PubTator3 instructions)
python pubtator3_api.py -q "@DISEASE_COVID_19 AND @GENE_PON1" [-o OUTPUT_FILEPATH]
```

2. Generate Cytoscape networks

```
# Index by the entity names referred to in the original articles
python pubtator2cytoscape.py -i examples/pmids_output.pubtator -o pmids_output.xgmml -w 1 --index_by name

# Index by MeSH terms and discard non-MeSH terms
python pubtator2cytoscape.py -i examples/pmids_output.pubtator -o pmids_output.xgmml -w 1 --index_by mesh

# Index by relations between entities (see PubTator3 for the detection of "relation")
python pubtator2cytoscape.py -i examples/pmids_output.pubtator -o pmids_output.xgmml -w 1 --index_by relation
```

3. Import the output xgmml file into Cytoscape to view the network.

For further usage, please refer to `notebooks`.

## Available Commands

### pubtator3_api.py
```
usage: pubtator3_api.py [-h] [-q QUERY] [-o OUTPUT] [-p PMIDS] [-f PMID_FILE] [--max_articles MAX_ARTICLES] [--full_text]
                        [--standardized_name] [--debug]

options:
  -h, --help            show this help message and exit
  -q QUERY, --query QUERY
                        Query string
  -o OUTPUT, --output OUTPUT
                        Output path
  -p PMIDS, --pmids PMIDS
                        PMIDs for the articles (comma-separated)
  -f PMID_FILE, --pmid_file PMID_FILE
                        Filepath to load PMIDs
  --max_articles MAX_ARTICLES
                        Maximal articles to request from the searching result (default: 1000)
  --full_text           Get full-text annotations
  --standardized_name   Obtain standardized names rather than the original text in articles
  --debug               Print debug information
```

### pubtator2cytoscape.py
```
usage: pubtator2cytoscape.py [-h] [-i INPUT] [-o OUTPUT] [-w CUT_WEIGHT] [--index_by {mesh,name,relation}] [--pmid_weight PMID_WEIGHT]

options:
  -h, --help            show this help message and exit
  -i INPUT, --input INPUT
                        Path to the pubtator file
  -o OUTPUT, --output OUTPUT
                        Output path (default: [INPUT FILEPATH].xgmml)
  -w CUT_WEIGHT, --cut_weight CUT_WEIGHT
                        Discard the edges with weight smaller than the specified value (default: 5)
  --index_by {mesh,name,relation}
                        Extract nodes and edges by
  --pmid_weight PMID_WEIGHT
                        csv file for the weight of the edge from a PMID (default: 1)
```
